<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>VolleyBoard Live+</title>
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="stylesheet" href="style.css">
  <meta name="theme-color" content="#0b0b0f"/>
</head>
<body>
<header class="appbar">
  <div class="left">
    <button id="homeBtnTop" class="icon-btn" title="Home">🏠</button>
    <button id="historyBtnTop" class="icon-btn" title="History">🗂️</button>
    <button id="bracketBtnTop" class="icon-btn" title="Bracket">🧩</button>
  </div>
  <div class="center">VolleyBoard Live+</div>
  <div class="right">
    <button id="themeBtn" class="icon-btn" title="Theme">🌓</button>
    <button id="liveBtnTop" class="icon-btn" title="Live">📡</button>
  </div>
</header>

<main>
  <section id="home" class="screen">
    <h1>🏐 VolleyBoard Live+</h1>

    <div class="row two">
      <div class="card">
        <h3>Mode</h3>
        <div class="chips" id="modeChips">
          <button class="chip active" data-mode="indoor">Indoor (Best of 5)</button>
          <button class="chip" data-mode="beach">Beach (Best of 3)</button>
        </div>

        <div class="chips" id="timedChips" style="margin-top:8px">
          <button class="chip active" data-timed="false">Untimed</button>
          <button class="chip" data-timed="true">Timed</button>
        </div>

        <div id="timeInputWrap" class="inline">
          <label>Match Duration</label>
          <input id="matchTime" type="text" value="20:00" placeholder="MM:SS"/>
        </div>

        <div class="inline">
          <label>Court</label>
          <select id="courtSelect"></select>
          <button id="newCourtBtn">+ Court</button>
        </div>

        <div class="inline">
          <button id="coinBtn" class="btn">🎲 Coin Toss</button>
          <span id="coinResult" class="note"></span>
        </div>
      </div>

      <div class="card">
        <h3>Teams</h3>
        <div class="two">
          <div>
            <label>Left Team Name</label>
            <input id="teamAName" type="text" value="Team A"/>
            <label class="small">Logo</label>
            <input id="logoA" type="file" accept="image/*">
            <div class="swatches" data-for="A"></div>
          </div>
          <div>
            <label>Right Team Name</label>
            <input id="teamBName" type="text" value="Team B"/>
            <label class="small">Logo</label>
            <input id="logoB" type="file" accept="image/*">
            <div class="swatches" data-for="B"></div>
          </div>
        </div>
        <details style="margin-top:8px">
          <summary>Indoor Rotations (optional)</summary>
          <div class="two">
            <div id="rotA" class="rot">
              <input placeholder="A1"><input placeholder="A2"><input placeholder="A3"><input placeholder="A4"><input placeholder="A5"><input placeholder="A6">
            </div>
            <div id="rotB" class="rot">
              <input placeholder="B1"><input placeholder="B2"><input placeholder="B3"><input placeholder="B4"><input placeholder="B5"><input placeholder="B6">
            </div>
          </div>
        </details>
      </div>
    </div>

    <div class="row two">
      <div class="card">
        <h3>Live Sharing</h3>
        <p class="note">Add your Firebase config in <code>firebase-config.js</code> (see README). Then click Go Live.</p>
        <button id="liveOpen" class="btn">📡 Go Live</button>
      </div>

      <div class="card">
        <h3>Start</h3>
        <button id="startBtn" class="btn cta">Start Match</button>
        <div class="note">Use History (🗂️) to see/save past matches.</div>
      </div>
    </div>
  </section>

  <section id="viewBanner" class="viewBanner hidden">Viewer Mode</section>

  <section id="board" class="screen hidden">
    <canvas id="confetti" class="confetti"></canvas>
    <div class="half" id="leftHalf">
      <div class="teamHeader">
        <img id="logoAImg" class="logo" alt="A">
        <div class="nameLine">
          <span id="serveA" class="serve hidden">🏐</span>
          <span id="nameA" class="teamName">Team A</span>
          <span id="rotationA" class="rotation hidden"></span>
        </div>
      </div>
      <div class="score" id="scoreA">0</div>
      <div class="bar">
        <button id="toA" class="btn small">Timeout</button>
        <span id="toDotsA" class="dots">■ ■</span>
      </div>
    </div>
    <div class="centerBar">
      <div id="setLine">Set 1 / Target 25</div>
      <div id="timerLine" class="hidden">⏱ <span id="timer">20:00</span></div>
      <div class="centerBtns">
        <button id="resetBtn" class="btn">Reset</button>
        <button id="statsBtn" class="btn">Stats</button>
      </div>
    </div>
    <div class="half" id="rightHalf">
      <div class="teamHeader">
        <div class="nameLine">
          <span id="rotationB" class="rotation hidden"></span>
          <span id="nameB" class="teamName">Team B</span>
          <span id="serveB" class="serve hidden">🏐</span>
        </div>
        <img id="logoBImg" class="logo" alt="B">
      </div>
      <div class="score" id="scoreB">0</div>
      <div class="bar">
        <button id="toB" class="btn small">Timeout</button>
        <span id="toDotsB" class="dots">■ ■</span>
      </div>
    </div>
  </section>

  <section id="fsModal" class="fsModal hidden">
    <div class="fsWindow">
      <div class="fsHeader">
        <h3 id="fsTitle"></h3>
        <button id="fsClose" class="icon-btn">✖</button>
      </div>
      <div id="fsBody" class="fsBody"></div>
    </div>
  </section>

  <section id="final" class="fsModal hidden">
    <div class="fsWindow">
      <div class="fsHeader">
        <h3>Match Over!</h3>
        <button id="finalClose" class="icon-btn">✖</button>
      </div>
      <div id="finalBody" class="fsBody mono"></div>
      <div class="row two">
        <button id="dlTxt" class="btn">Download TXT</button>
        <button id="dlCsv" class="btn">Download CSV</button>
        <button id="againBtn" class="btn">Play Again</button>
        <button id="homeEndBtn" class="btn">Home</button>
      </div>
    </div>
  </section>

  <section id="historyPanel" class="fsModal hidden">
    <div class="fsWindow">
      <div class="fsHeader">
        <h3>🗂️ Match History</h3>
        <button id="historyClose" class="icon-btn">✖</button>
      </div>
      <div id="historyBody" class="fsBody"></div>
      <div class="row">
        <button id="historyClear" class="btn">Clear History</button>
      </div>
    </div>
  </section>
</main>

<script src="firebase-config.js"></script>
<script src="app.js"></script>
<script>
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('service-worker.js');
  });
}
</script>
</body>
</html>
